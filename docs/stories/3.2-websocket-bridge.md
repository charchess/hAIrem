# Story 3.2: Connecteur WebSocket Redis (The Bridge)

**Status:** Draft
**Story:**
**As a** Frontend Application,
**I want** to receive H-Link messages in real-time via WebSockets,
**so that** I can update the character poses and dialogue instantly.

## Acceptance Criteria
1.  Un serveur WebSocket est intégré au `h-core` (utilisant FastAPI/FastAPI-Users ou simple WebSocket).
2.  Le serveur s'abonne au bus Redis et retransmet tous les messages `narrative.*` aux clients connectés.
3.  Le client Frontend (`a2ui`) se connecte automatiquement au démarrage.
4.  Validation : Un message publié sur Redis apparaît dans la console du navigateur.

## Tasks / Subtasks
- [ ] Task 1: FastAPI WebSocket (AC: 1)
    - [ ] Créer l'endpoint `/ws` dans `apps/h-core/src/main.py`.
- [ ] Task 2: Redis-to-WS Bridge (AC: 2)
    - [ ] Implémenter une boucle asynchrone qui écoute Redis et envoie les JSON via WS.
- [ ] Task 3: JS WebSocket Client (AC: 3)
    - [ ] Créer `apps/a2ui/js/network.js` pour gérer la connexion.

## Dev Notes
**Technical Context from Architecture:**

*   **Communication:**
    - Bus Redis -> WebSocket Server -> Browser Client.
    - Format: JSON H-Link v1.0.

### Testing
*   **Testing Standards:**
    - Utiliser `scripts/test_redis.py` pour publier un message et vérifier sa réception dans le client WS.

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2026-01-20 | 1.0 | Initial draft | Bob (SM) |
